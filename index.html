<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Valentine</title>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(#ffeef6,#ffd6e7);
  font-family:sans-serif;
  overflow:hidden;
}

.card{
  background:white;
  padding:30px;
  border-radius:20px;
  text-align:center;
  box-shadow:0 15px 40px rgba(0,0,0,.2);
}

.zone{
  position:relative;
  width:300px;
  height:140px;
  margin:auto;
}

button{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  padding:12px 22px;
  font-size:18px;
  border:none;
  border-radius:999px;
  font-weight:bold;
  cursor:pointer;
}

#yes{
  left:20%;
  background:#ff3b7a;
  color:white;
  z-index:2;
}

#no{
  left:60%;
  background:#ddd;
  z-index:1;
}

.result{
  display:none;
  margin-top:20px;
}

canvas{
  position:fixed;
  inset:0;
  pointer-events:none;
}
</style>
</head>

<body>

<canvas id="c"></canvas>

<div class="card">
  <h2>Ines, will you be my valentine?</h2>

  <div class="zone" id="zone">
    <button id="yes">Yes</button>
    <button id="no">No</button>
  </div>

  <div class="result" id="result">
    <h1 style="color:#ff3b7a">!YOU CLICKED YES!</h1>
    <h2>YAY! ðŸŽ‰</h2>

    <img src="https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExYjN4YjQ2YXVjcXRleDFhdno1Y3czZjVzd2M2N29qcmZnMGJhYzJnYSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Nvt8Y0E4IZdE4Ao3Q3/giphy.gif" width="260">
  </div>
</div>

<script>
const zone = document.getElementById("zone");
const yes = document.getElementById("yes");
const no = document.getElementById("no");
const result = document.getElementById("result");

const conf = confetti.create(document.getElementById("c"), { resize:true });

let scale = 1;
function grow(){
  scale += 0.1;
  yes.style.transform = `translateY(-50%) scale(${scale})`;
}

function clamp(n,min,max){
  return Math.max(min, Math.min(max, n));
}

function move(x,y){
  const z = zone.getBoundingClientRect();
  const b = no.getBoundingClientRect();
  const yb = yes.getBoundingClientRect();

  let dx = (b.left + b.width/2) - x;
  let dy = (b.top + b.height/2) - y;

  const m = Math.hypot(dx,dy) || 1;
  dx /= m;
  dy /= m;

  let l = (b.left - z.left) + dx * 140;
  let t = (b.top - z.top) + dy * 140;

  l = clamp(l, 0, z.width - b.width);
  t = clamp(t, 0, z.height - b.height);

  // blokada nachodzenia na YES
  const overlapX =
    l + b.width > (yb.left - z.left) &&
    l < (yb.right - z.left);

  const overlapY =
    t + b.height > (yb.top - z.top) &&
    t < (yb.bottom - z.top);

  if(overlapX && overlapY){
    l = Math.random() * (z.width - b.width);
    t = Math.random() * (z.height - b.height);
  }

  no.style.left = l + "px";
  no.style.top = t + "px";

  grow();
}

function handle(e){
  const p = e.touches ? e.touches[0] : e;
  move(p.clientX, p.clientY);
}

zone.addEventListener("pointermove", handle);
zone.addEventListener("pointerdown", handle);
zone.addEventListener("touchstart", handle);
zone.addEventListener("touchmove", handle);

no.onclick = e => e.preventDefault();

yes.onclick = () => {
  zone.style.display = "none";
  result.style.display = "block";
  conf({ particleCount:300, spread:120 });
};
</script>

</body>
</html>
